{"ast":null,"code":"var sax = require('sax');\nvar expat /*= require('node-expat');*/ = {\n  on: function () {},\n  parse: function () {}\n};\nvar helper = require('./options-helper');\nvar isArray = require('./array-helper').isArray;\nvar options;\nvar pureJsParser = true;\nvar currentElement;\nfunction validateOptions(userOptions) {\n  options = helper.copyOptions(userOptions);\n  helper.ensureFlagExists('ignoreDeclaration', options);\n  helper.ensureFlagExists('ignoreInstruction', options);\n  helper.ensureFlagExists('ignoreAttributes', options);\n  helper.ensureFlagExists('ignoreText', options);\n  helper.ensureFlagExists('ignoreComment', options);\n  helper.ensureFlagExists('ignoreCdata', options);\n  helper.ensureFlagExists('ignoreDoctype', options);\n  helper.ensureFlagExists('compact', options);\n  helper.ensureFlagExists('alwaysChildren', options);\n  helper.ensureFlagExists('addParent', options);\n  helper.ensureFlagExists('trim', options);\n  helper.ensureFlagExists('nativeType', options);\n  helper.ensureFlagExists('nativeTypeAttributes', options);\n  helper.ensureFlagExists('sanitize', options);\n  helper.ensureFlagExists('instructionHasAttributes', options);\n  helper.ensureFlagExists('captureSpacesBetweenElements', options);\n  helper.ensureAlwaysArrayExists(options);\n  helper.ensureKeyExists('declaration', options);\n  helper.ensureKeyExists('instruction', options);\n  helper.ensureKeyExists('attributes', options);\n  helper.ensureKeyExists('text', options);\n  helper.ensureKeyExists('comment', options);\n  helper.ensureKeyExists('cdata', options);\n  helper.ensureKeyExists('doctype', options);\n  helper.ensureKeyExists('type', options);\n  helper.ensureKeyExists('name', options);\n  helper.ensureKeyExists('elements', options);\n  helper.ensureKeyExists('parent', options);\n  helper.checkFnExists('doctype', options);\n  helper.checkFnExists('instruction', options);\n  helper.checkFnExists('cdata', options);\n  helper.checkFnExists('comment', options);\n  helper.checkFnExists('text', options);\n  helper.checkFnExists('instructionName', options);\n  helper.checkFnExists('elementName', options);\n  helper.checkFnExists('attributeName', options);\n  helper.checkFnExists('attributeValue', options);\n  helper.checkFnExists('attributes', options);\n  return options;\n}\nfunction nativeType(value) {\n  var nValue = Number(value);\n  if (!isNaN(nValue)) {\n    return nValue;\n  }\n  var bValue = value.toLowerCase();\n  if (bValue === 'true') {\n    return true;\n  } else if (bValue === 'false') {\n    return false;\n  }\n  return value;\n}\nfunction addField(type, value) {\n  var key;\n  if (options.compact) {\n    if (!currentElement[options[type + 'Key']] && (isArray(options.alwaysArray) ? options.alwaysArray.indexOf(options[type + 'Key']) !== -1 : options.alwaysArray)) {\n      currentElement[options[type + 'Key']] = [];\n    }\n    if (currentElement[options[type + 'Key']] && !isArray(currentElement[options[type + 'Key']])) {\n      currentElement[options[type + 'Key']] = [currentElement[options[type + 'Key']]];\n    }\n    if (type + 'Fn' in options && typeof value === 'string') {\n      value = options[type + 'Fn'](value, currentElement);\n    }\n    if (type === 'instruction' && ('instructionFn' in options || 'instructionNameFn' in options)) {\n      for (key in value) {\n        if (value.hasOwnProperty(key)) {\n          if ('instructionFn' in options) {\n            value[key] = options.instructionFn(value[key], key, currentElement);\n          } else {\n            var temp = value[key];\n            delete value[key];\n            value[options.instructionNameFn(key, temp, currentElement)] = temp;\n          }\n        }\n      }\n    }\n    if (isArray(currentElement[options[type + 'Key']])) {\n      currentElement[options[type + 'Key']].push(value);\n    } else {\n      currentElement[options[type + 'Key']] = value;\n    }\n  } else {\n    if (!currentElement[options.elementsKey]) {\n      currentElement[options.elementsKey] = [];\n    }\n    var element = {};\n    element[options.typeKey] = type;\n    if (type === 'instruction') {\n      for (key in value) {\n        if (value.hasOwnProperty(key)) {\n          break;\n        }\n      }\n      element[options.nameKey] = 'instructionNameFn' in options ? options.instructionNameFn(key, value, currentElement) : key;\n      if (options.instructionHasAttributes) {\n        element[options.attributesKey] = value[key][options.attributesKey];\n        if ('instructionFn' in options) {\n          element[options.attributesKey] = options.instructionFn(element[options.attributesKey], key, currentElement);\n        }\n      } else {\n        if ('instructionFn' in options) {\n          value[key] = options.instructionFn(value[key], key, currentElement);\n        }\n        element[options.instructionKey] = value[key];\n      }\n    } else {\n      if (type + 'Fn' in options) {\n        value = options[type + 'Fn'](value, currentElement);\n      }\n      element[options[type + 'Key']] = value;\n    }\n    if (options.addParent) {\n      element[options.parentKey] = currentElement;\n    }\n    currentElement[options.elementsKey].push(element);\n  }\n}\nfunction manipulateAttributes(attributes) {\n  if ('attributesFn' in options && attributes) {\n    attributes = options.attributesFn(attributes, currentElement);\n  }\n  if ((options.trim || 'attributeValueFn' in options || 'attributeNameFn' in options || options.nativeTypeAttributes) && attributes) {\n    var key;\n    for (key in attributes) {\n      if (attributes.hasOwnProperty(key)) {\n        if (options.trim) attributes[key] = attributes[key].trim();\n        if (options.nativeTypeAttributes) {\n          attributes[key] = nativeType(attributes[key]);\n        }\n        if ('attributeValueFn' in options) attributes[key] = options.attributeValueFn(attributes[key], key, currentElement);\n        if ('attributeNameFn' in options) {\n          var temp = attributes[key];\n          delete attributes[key];\n          attributes[options.attributeNameFn(key, attributes[key], currentElement)] = temp;\n        }\n      }\n    }\n  }\n  return attributes;\n}\nfunction onInstruction(instruction) {\n  var attributes = {};\n  if (instruction.body && (instruction.name.toLowerCase() === 'xml' || options.instructionHasAttributes)) {\n    var attrsRegExp = /([\\w:-]+)\\s*=\\s*(?:\"([^\"]*)\"|'([^']*)'|(\\w+))\\s*/g;\n    var match;\n    while ((match = attrsRegExp.exec(instruction.body)) !== null) {\n      attributes[match[1]] = match[2] || match[3] || match[4];\n    }\n    attributes = manipulateAttributes(attributes);\n  }\n  if (instruction.name.toLowerCase() === 'xml') {\n    if (options.ignoreDeclaration) {\n      return;\n    }\n    currentElement[options.declarationKey] = {};\n    if (Object.keys(attributes).length) {\n      currentElement[options.declarationKey][options.attributesKey] = attributes;\n    }\n    if (options.addParent) {\n      currentElement[options.declarationKey][options.parentKey] = currentElement;\n    }\n  } else {\n    if (options.ignoreInstruction) {\n      return;\n    }\n    if (options.trim) {\n      instruction.body = instruction.body.trim();\n    }\n    var value = {};\n    if (options.instructionHasAttributes && Object.keys(attributes).length) {\n      value[instruction.name] = {};\n      value[instruction.name][options.attributesKey] = attributes;\n    } else {\n      value[instruction.name] = instruction.body;\n    }\n    addField('instruction', value);\n  }\n}\nfunction onStartElement(name, attributes) {\n  var element;\n  if (typeof name === 'object') {\n    attributes = name.attributes;\n    name = name.name;\n  }\n  attributes = manipulateAttributes(attributes);\n  if ('elementNameFn' in options) {\n    name = options.elementNameFn(name, currentElement);\n  }\n  if (options.compact) {\n    element = {};\n    if (!options.ignoreAttributes && attributes && Object.keys(attributes).length) {\n      element[options.attributesKey] = {};\n      var key;\n      for (key in attributes) {\n        if (attributes.hasOwnProperty(key)) {\n          element[options.attributesKey][key] = attributes[key];\n        }\n      }\n    }\n    if (!(name in currentElement) && (isArray(options.alwaysArray) ? options.alwaysArray.indexOf(name) !== -1 : options.alwaysArray)) {\n      currentElement[name] = [];\n    }\n    if (currentElement[name] && !isArray(currentElement[name])) {\n      currentElement[name] = [currentElement[name]];\n    }\n    if (isArray(currentElement[name])) {\n      currentElement[name].push(element);\n    } else {\n      currentElement[name] = element;\n    }\n  } else {\n    if (!currentElement[options.elementsKey]) {\n      currentElement[options.elementsKey] = [];\n    }\n    element = {};\n    element[options.typeKey] = 'element';\n    element[options.nameKey] = name;\n    if (!options.ignoreAttributes && attributes && Object.keys(attributes).length) {\n      element[options.attributesKey] = attributes;\n    }\n    if (options.alwaysChildren) {\n      element[options.elementsKey] = [];\n    }\n    currentElement[options.elementsKey].push(element);\n  }\n  element[options.parentKey] = currentElement; // will be deleted in onEndElement() if !options.addParent\n  currentElement = element;\n}\nfunction onText(text) {\n  if (options.ignoreText) {\n    return;\n  }\n  if (!text.trim() && !options.captureSpacesBetweenElements) {\n    return;\n  }\n  if (options.trim) {\n    text = text.trim();\n  }\n  if (options.nativeType) {\n    text = nativeType(text);\n  }\n  if (options.sanitize) {\n    text = text.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');\n  }\n  addField('text', text);\n}\nfunction onComment(comment) {\n  if (options.ignoreComment) {\n    return;\n  }\n  if (options.trim) {\n    comment = comment.trim();\n  }\n  addField('comment', comment);\n}\nfunction onEndElement(name) {\n  var parentElement = currentElement[options.parentKey];\n  if (!options.addParent) {\n    delete currentElement[options.parentKey];\n  }\n  currentElement = parentElement;\n}\nfunction onCdata(cdata) {\n  if (options.ignoreCdata) {\n    return;\n  }\n  if (options.trim) {\n    cdata = cdata.trim();\n  }\n  addField('cdata', cdata);\n}\nfunction onDoctype(doctype) {\n  if (options.ignoreDoctype) {\n    return;\n  }\n  doctype = doctype.replace(/^ /, '');\n  if (options.trim) {\n    doctype = doctype.trim();\n  }\n  addField('doctype', doctype);\n}\nfunction onError(error) {\n  error.note = error; //console.error(error);\n}\n\nmodule.exports = function (xml, userOptions) {\n  var parser = pureJsParser ? sax.parser(true, {}) : parser = new expat.Parser('UTF-8');\n  var result = {};\n  currentElement = result;\n  options = validateOptions(userOptions);\n  if (pureJsParser) {\n    parser.opt = {\n      strictEntities: true\n    };\n    parser.onopentag = onStartElement;\n    parser.ontext = onText;\n    parser.oncomment = onComment;\n    parser.onclosetag = onEndElement;\n    parser.onerror = onError;\n    parser.oncdata = onCdata;\n    parser.ondoctype = onDoctype;\n    parser.onprocessinginstruction = onInstruction;\n  } else {\n    parser.on('startElement', onStartElement);\n    parser.on('text', onText);\n    parser.on('comment', onComment);\n    parser.on('endElement', onEndElement);\n    parser.on('error', onError);\n    //parser.on('startCdata', onStartCdata);\n    //parser.on('endCdata', onEndCdata);\n    //parser.on('entityDecl', onEntityDecl);\n  }\n\n  if (pureJsParser) {\n    parser.write(xml).close();\n  } else {\n    if (!parser.parse(xml)) {\n      throw new Error('XML parsing error: ' + parser.getError());\n    }\n  }\n  if (result[options.elementsKey]) {\n    var temp = result[options.elementsKey];\n    delete result[options.elementsKey];\n    result[options.elementsKey] = temp;\n    delete result.text;\n  }\n  return result;\n};","map":{"version":3,"names":["sax","require","expat","on","parse","helper","isArray","options","pureJsParser","currentElement","validateOptions","userOptions","copyOptions","ensureFlagExists","ensureAlwaysArrayExists","ensureKeyExists","checkFnExists","nativeType","value","nValue","Number","isNaN","bValue","toLowerCase","addField","type","key","compact","alwaysArray","indexOf","hasOwnProperty","instructionFn","temp","instructionNameFn","push","elementsKey","element","typeKey","nameKey","instructionHasAttributes","attributesKey","instructionKey","addParent","parentKey","manipulateAttributes","attributes","attributesFn","trim","nativeTypeAttributes","attributeValueFn","attributeNameFn","onInstruction","instruction","body","name","attrsRegExp","match","exec","ignoreDeclaration","declarationKey","Object","keys","length","ignoreInstruction","onStartElement","elementNameFn","ignoreAttributes","alwaysChildren","onText","text","ignoreText","captureSpacesBetweenElements","sanitize","replace","onComment","comment","ignoreComment","onEndElement","parentElement","onCdata","cdata","ignoreCdata","onDoctype","doctype","ignoreDoctype","onError","error","note","module","exports","xml","parser","Parser","result","opt","strictEntities","onopentag","ontext","oncomment","onclosetag","onerror","oncdata","ondoctype","onprocessinginstruction","write","close","Error","getError"],"sources":["/home/miltonejones/projects/state-cast/node_modules/xml-js/lib/xml2js.js"],"sourcesContent":["var sax = require('sax');\r\nvar expat /*= require('node-expat');*/ = { on: function () { }, parse: function () { } };\r\nvar helper = require('./options-helper');\r\nvar isArray = require('./array-helper').isArray;\r\n\r\nvar options;\r\nvar pureJsParser = true;\r\nvar currentElement;\r\n\r\nfunction validateOptions(userOptions) {\r\n  options = helper.copyOptions(userOptions);\r\n  helper.ensureFlagExists('ignoreDeclaration', options);\r\n  helper.ensureFlagExists('ignoreInstruction', options);\r\n  helper.ensureFlagExists('ignoreAttributes', options);\r\n  helper.ensureFlagExists('ignoreText', options);\r\n  helper.ensureFlagExists('ignoreComment', options);\r\n  helper.ensureFlagExists('ignoreCdata', options);\r\n  helper.ensureFlagExists('ignoreDoctype', options);\r\n  helper.ensureFlagExists('compact', options);\r\n  helper.ensureFlagExists('alwaysChildren', options);\r\n  helper.ensureFlagExists('addParent', options);\r\n  helper.ensureFlagExists('trim', options);\r\n  helper.ensureFlagExists('nativeType', options);\r\n  helper.ensureFlagExists('nativeTypeAttributes', options);\r\n  helper.ensureFlagExists('sanitize', options);\r\n  helper.ensureFlagExists('instructionHasAttributes', options);\r\n  helper.ensureFlagExists('captureSpacesBetweenElements', options);\r\n  helper.ensureAlwaysArrayExists(options);\r\n  helper.ensureKeyExists('declaration', options);\r\n  helper.ensureKeyExists('instruction', options);\r\n  helper.ensureKeyExists('attributes', options);\r\n  helper.ensureKeyExists('text', options);\r\n  helper.ensureKeyExists('comment', options);\r\n  helper.ensureKeyExists('cdata', options);\r\n  helper.ensureKeyExists('doctype', options);\r\n  helper.ensureKeyExists('type', options);\r\n  helper.ensureKeyExists('name', options);\r\n  helper.ensureKeyExists('elements', options);\r\n  helper.ensureKeyExists('parent', options);\r\n  helper.checkFnExists('doctype', options);\r\n  helper.checkFnExists('instruction', options);\r\n  helper.checkFnExists('cdata', options);\r\n  helper.checkFnExists('comment', options);\r\n  helper.checkFnExists('text', options);\r\n  helper.checkFnExists('instructionName', options);\r\n  helper.checkFnExists('elementName', options);\r\n  helper.checkFnExists('attributeName', options);\r\n  helper.checkFnExists('attributeValue', options);\r\n  helper.checkFnExists('attributes', options);\r\n  return options;\r\n}\r\n\r\nfunction nativeType(value) {\r\n  var nValue = Number(value);\r\n  if (!isNaN(nValue)) {\r\n    return nValue;\r\n  }\r\n  var bValue = value.toLowerCase();\r\n  if (bValue === 'true') {\r\n    return true;\r\n  } else if (bValue === 'false') {\r\n    return false;\r\n  }\r\n  return value;\r\n}\r\n\r\nfunction addField(type, value) {\r\n  var key;\r\n  if (options.compact) {\r\n    if (\r\n      !currentElement[options[type + 'Key']] &&\r\n      (isArray(options.alwaysArray) ? options.alwaysArray.indexOf(options[type + 'Key']) !== -1 : options.alwaysArray)\r\n    ) {\r\n      currentElement[options[type + 'Key']] = [];\r\n    }\r\n    if (currentElement[options[type + 'Key']] && !isArray(currentElement[options[type + 'Key']])) {\r\n      currentElement[options[type + 'Key']] = [currentElement[options[type + 'Key']]];\r\n    }\r\n    if (type + 'Fn' in options && typeof value === 'string') {\r\n      value = options[type + 'Fn'](value, currentElement);\r\n    }\r\n    if (type === 'instruction' && ('instructionFn' in options || 'instructionNameFn' in options)) {\r\n      for (key in value) {\r\n        if (value.hasOwnProperty(key)) {\r\n          if ('instructionFn' in options) {\r\n            value[key] = options.instructionFn(value[key], key, currentElement);\r\n          } else {\r\n            var temp = value[key];\r\n            delete value[key];\r\n            value[options.instructionNameFn(key, temp, currentElement)] = temp;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    if (isArray(currentElement[options[type + 'Key']])) {\r\n      currentElement[options[type + 'Key']].push(value);\r\n    } else {\r\n      currentElement[options[type + 'Key']] = value;\r\n    }\r\n  } else {\r\n    if (!currentElement[options.elementsKey]) {\r\n      currentElement[options.elementsKey] = [];\r\n    }\r\n    var element = {};\r\n    element[options.typeKey] = type;\r\n    if (type === 'instruction') {\r\n      for (key in value) {\r\n        if (value.hasOwnProperty(key)) {\r\n          break;\r\n        }\r\n      }\r\n      element[options.nameKey] = 'instructionNameFn' in options ? options.instructionNameFn(key, value, currentElement) : key;\r\n      if (options.instructionHasAttributes) {\r\n        element[options.attributesKey] = value[key][options.attributesKey];\r\n        if ('instructionFn' in options) {\r\n          element[options.attributesKey] = options.instructionFn(element[options.attributesKey], key, currentElement);\r\n        }\r\n      } else {\r\n        if ('instructionFn' in options) {\r\n          value[key] = options.instructionFn(value[key], key, currentElement);\r\n        }\r\n        element[options.instructionKey] = value[key];\r\n      }\r\n    } else {\r\n      if (type + 'Fn' in options) {\r\n        value = options[type + 'Fn'](value, currentElement);\r\n      }\r\n      element[options[type + 'Key']] = value;\r\n    }\r\n    if (options.addParent) {\r\n      element[options.parentKey] = currentElement;\r\n    }\r\n    currentElement[options.elementsKey].push(element);\r\n  }\r\n}\r\n\r\nfunction manipulateAttributes(attributes) {\r\n  if ('attributesFn' in options && attributes) {\r\n    attributes = options.attributesFn(attributes, currentElement);\r\n  }\r\n  if ((options.trim || 'attributeValueFn' in options || 'attributeNameFn' in options || options.nativeTypeAttributes) && attributes) {\r\n    var key;\r\n    for (key in attributes) {\r\n      if (attributes.hasOwnProperty(key)) {\r\n        if (options.trim) attributes[key] = attributes[key].trim();\r\n        if (options.nativeTypeAttributes) {\r\n          attributes[key] = nativeType(attributes[key]);\r\n        }\r\n        if ('attributeValueFn' in options) attributes[key] = options.attributeValueFn(attributes[key], key, currentElement);\r\n        if ('attributeNameFn' in options) {\r\n          var temp = attributes[key];\r\n          delete attributes[key];\r\n          attributes[options.attributeNameFn(key, attributes[key], currentElement)] = temp;\r\n        }\r\n      }\r\n    }\r\n  }\r\n  return attributes;\r\n}\r\n\r\nfunction onInstruction(instruction) {\r\n  var attributes = {};\r\n  if (instruction.body && (instruction.name.toLowerCase() === 'xml' || options.instructionHasAttributes)) {\r\n    var attrsRegExp = /([\\w:-]+)\\s*=\\s*(?:\"([^\"]*)\"|'([^']*)'|(\\w+))\\s*/g;\r\n    var match;\r\n    while ((match = attrsRegExp.exec(instruction.body)) !== null) {\r\n      attributes[match[1]] = match[2] || match[3] || match[4];\r\n    }\r\n    attributes = manipulateAttributes(attributes);\r\n  }\r\n  if (instruction.name.toLowerCase() === 'xml') {\r\n    if (options.ignoreDeclaration) {\r\n      return;\r\n    }\r\n    currentElement[options.declarationKey] = {};\r\n    if (Object.keys(attributes).length) {\r\n      currentElement[options.declarationKey][options.attributesKey] = attributes;\r\n    }\r\n    if (options.addParent) {\r\n      currentElement[options.declarationKey][options.parentKey] = currentElement;\r\n    }\r\n  } else {\r\n    if (options.ignoreInstruction) {\r\n      return;\r\n    }\r\n    if (options.trim) {\r\n      instruction.body = instruction.body.trim();\r\n    }\r\n    var value = {};\r\n    if (options.instructionHasAttributes && Object.keys(attributes).length) {\r\n      value[instruction.name] = {};\r\n      value[instruction.name][options.attributesKey] = attributes;\r\n    } else {\r\n      value[instruction.name] = instruction.body;\r\n    }\r\n    addField('instruction', value);\r\n  }\r\n}\r\n\r\nfunction onStartElement(name, attributes) {\r\n  var element;\r\n  if (typeof name === 'object') {\r\n    attributes = name.attributes;\r\n    name = name.name;\r\n  }\r\n  attributes = manipulateAttributes(attributes);\r\n  if ('elementNameFn' in options) {\r\n    name = options.elementNameFn(name, currentElement);\r\n  }\r\n  if (options.compact) {\r\n    element = {};\r\n    if (!options.ignoreAttributes && attributes && Object.keys(attributes).length) {\r\n      element[options.attributesKey] = {};\r\n      var key;\r\n      for (key in attributes) {\r\n        if (attributes.hasOwnProperty(key)) {\r\n          element[options.attributesKey][key] = attributes[key];\r\n        }\r\n      }\r\n    }\r\n    if (\r\n      !(name in currentElement) &&\r\n      (isArray(options.alwaysArray) ? options.alwaysArray.indexOf(name) !== -1 : options.alwaysArray)\r\n    ) {\r\n      currentElement[name] = [];\r\n    }\r\n    if (currentElement[name] && !isArray(currentElement[name])) {\r\n      currentElement[name] = [currentElement[name]];\r\n    }\r\n    if (isArray(currentElement[name])) {\r\n      currentElement[name].push(element);\r\n    } else {\r\n      currentElement[name] = element;\r\n    }\r\n  } else {\r\n    if (!currentElement[options.elementsKey]) {\r\n      currentElement[options.elementsKey] = [];\r\n    }\r\n    element = {};\r\n    element[options.typeKey] = 'element';\r\n    element[options.nameKey] = name;\r\n    if (!options.ignoreAttributes && attributes && Object.keys(attributes).length) {\r\n      element[options.attributesKey] = attributes;\r\n    }\r\n    if (options.alwaysChildren) {\r\n      element[options.elementsKey] = [];\r\n    }\r\n    currentElement[options.elementsKey].push(element);\r\n  }\r\n  element[options.parentKey] = currentElement; // will be deleted in onEndElement() if !options.addParent\r\n  currentElement = element;\r\n}\r\n\r\nfunction onText(text) {\r\n  if (options.ignoreText) {\r\n    return;\r\n  }\r\n  if (!text.trim() && !options.captureSpacesBetweenElements) {\r\n    return;\r\n  }\r\n  if (options.trim) {\r\n    text = text.trim();\r\n  }\r\n  if (options.nativeType) {\r\n    text = nativeType(text);\r\n  }\r\n  if (options.sanitize) {\r\n    text = text.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');\r\n  }\r\n  addField('text', text);\r\n}\r\n\r\nfunction onComment(comment) {\r\n  if (options.ignoreComment) {\r\n    return;\r\n  }\r\n  if (options.trim) {\r\n    comment = comment.trim();\r\n  }\r\n  addField('comment', comment);\r\n}\r\n\r\nfunction onEndElement(name) {\r\n  var parentElement = currentElement[options.parentKey];\r\n  if (!options.addParent) {\r\n    delete currentElement[options.parentKey];\r\n  }\r\n  currentElement = parentElement;\r\n}\r\n\r\nfunction onCdata(cdata) {\r\n  if (options.ignoreCdata) {\r\n    return;\r\n  }\r\n  if (options.trim) {\r\n    cdata = cdata.trim();\r\n  }\r\n  addField('cdata', cdata);\r\n}\r\n\r\nfunction onDoctype(doctype) {\r\n  if (options.ignoreDoctype) {\r\n    return;\r\n  }\r\n  doctype = doctype.replace(/^ /, '');\r\n  if (options.trim) {\r\n    doctype = doctype.trim();\r\n  }\r\n  addField('doctype', doctype);\r\n}\r\n\r\nfunction onError(error) {\r\n  error.note = error; //console.error(error);\r\n}\r\n\r\nmodule.exports = function (xml, userOptions) {\r\n\r\n  var parser = pureJsParser ? sax.parser(true, {}) : parser = new expat.Parser('UTF-8');\r\n  var result = {};\r\n  currentElement = result;\r\n\r\n  options = validateOptions(userOptions);\r\n\r\n  if (pureJsParser) {\r\n    parser.opt = {strictEntities: true};\r\n    parser.onopentag = onStartElement;\r\n    parser.ontext = onText;\r\n    parser.oncomment = onComment;\r\n    parser.onclosetag = onEndElement;\r\n    parser.onerror = onError;\r\n    parser.oncdata = onCdata;\r\n    parser.ondoctype = onDoctype;\r\n    parser.onprocessinginstruction = onInstruction;\r\n  } else {\r\n    parser.on('startElement', onStartElement);\r\n    parser.on('text', onText);\r\n    parser.on('comment', onComment);\r\n    parser.on('endElement', onEndElement);\r\n    parser.on('error', onError);\r\n    //parser.on('startCdata', onStartCdata);\r\n    //parser.on('endCdata', onEndCdata);\r\n    //parser.on('entityDecl', onEntityDecl);\r\n  }\r\n\r\n  if (pureJsParser) {\r\n    parser.write(xml).close();\r\n  } else {\r\n    if (!parser.parse(xml)) {\r\n      throw new Error('XML parsing error: ' + parser.getError());\r\n    }\r\n  }\r\n\r\n  if (result[options.elementsKey]) {\r\n    var temp = result[options.elementsKey];\r\n    delete result[options.elementsKey];\r\n    result[options.elementsKey] = temp;\r\n    delete result.text;\r\n  }\r\n\r\n  return result;\r\n\r\n};\r\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}